RSE<-c()
R_sq<-c()
model_1<-lm(lpsa~lcavol,data=prostate)
summary(model_1)
R_sq<-append(summary(model_1)$r.squared,R_sq)
summary(model_1)$standard
summary(model_1)$standard.error
help("summary.lm")
summary(model_1)$sigma
# Initializing vector to store the model metrics
RSE<-c()
R_sq<-c()
model_1<-lm(lpsa~lcavol,data=prostate)
summary(model_1)
R_sq<-append(summary(model_1)$r.squared,R_sq)
RSE<-append(summary(model_1)$sigma,RSE)
lm(lpsa~names(prostate)[1:2],data=prostate)
lm(lpsa~ .-names(prostate)[1],data=prostate)
names(prostate)[1]
prostate[1]
variable.names(prostate)
variable.names(prostate)[1]
lm(lpsa~ .-variable.names(prostate)[1],data=prostate)
prostate[1,1]
# Initializing vector to store the model metrics
RSE<-c()
R_sq<-c()
# One predictor
model_1<-lm(lpsa~lcavol,data=prostate)
summary(model_1)
R_sq<-append(summary(model_1)$r.squared,R_sq)
RSE<-append(summary(model_1)$sigma,RSE)
#Two predictors
model_2<-update(model_1, . ~ . + lweight)
summary(model_2)
R_sq<-append(summary(model_1)$r.squared,R_sq)
RSE<-append(summary(model_1)$sigma,RSE)
# Initializing vector to store the model metrics
RSE<-c()
R_sq<-c()
# One predictor
model_1<-lm(lpsa~lcavol,data=prostate)
summary(model_1)
R_sq<-append(summary(model_1)$r.squared,R_sq)
RSE<-append(summary(model_1)$sigma,RSE)
#Two predictors
model_2<-update(model_1, . ~ . + lweight)
summary(model_2)
R_sq<-append(summary(model_2)$r.squared,R_sq)
RSE<-append(summary(model_2)$sigma,RSE)
#Three predictors
model_3<-update(model_2, . ~ . + svi)
summary(model_3)
R_sq<-append(summary(model_3)$r.squared,R_sq)
RSE<-append(summary(model_3)$sigma,RSE)
#Four predictors
model_4<-update(model_3, . ~ . + lbph)
summary(model_4)
R_sq<-append(summary(model_4)$r.squared,R_sq)
RSE<-append(summary(model_4)$sigma,RSE)
#Five predictors
model_5<-update(model_4, . ~ . + age)
summary(model_5)
R_sq<-append(summary(model_5)$r.squared,R_sq)
RSE<-append(summary(model_5)$sigma,RSE)
#Six predictors
model_6<-update(model_5, . ~ . + lcp)
summary(model_6)
R_sq<-append(summary(model_6)$r.squared,R_sq)
RSE<-append(summary(model_6)$sigma,RSE)
#Seven predictors
model_7<-update(model_6, . ~ . + pgg45)
summary(model_7)
R_sq<-append(summary(model_7)$r.squared,R_sq)
RSE<-append(summary(model_7)$sigma,RSE)
#Eight predictors
model_8<-update(model_7, . ~ . + gleason)
summary(model_8)
R_sq<-append(summary(model_8)$r.squared,R_sq)
RSE<-append(summary(model_8)$sigma,RSE)
Model<-seq(1,8,1)
Model<-seq(1,8,1)
plot(Model,R_sq)
Model<-seq(1,8,1)
plot(Model,R_sq)
# Initializing vector to store the model metrics
RSE<-c()
R_sq<-c()
# Baseline Model
model_1<-lm(lpsa~lcavol,data=prostate)
summary(model_1)
R_sq<-append(R_sq,summary(model_1)$r.squared)
RSE<-append(RSE,summary(model_1)$sigma)
#One predictor added
model_2<-update(model_1, . ~ . + lweight)
summary(model_2)
R_sq<-append(R_sq,summary(model_2)$r.squared)
RSE<-append(RSE, summary(model_2)$sigma)
#Two predictors added
model_3<-update(model_2, . ~ . + svi)
summary(model_3)
R_sq<-append(R_sq, summary(model_3)$r.squared)
RSE<-append(RSE, summary(model_3)$sigma)
#Three predictors added
model_4<-update(model_3, . ~ . + lbph)
summary(model_4)
R_sq<-append(R_sq,summary(model_4)$r.squared)
RSE<-append(RSE,summary(model_4)$sigma)
#Four predictors added
model_5<-update(model_4, . ~ . + age)
summary(model_5)
R_sq<-append(R_sq,summary(model_5)$r.squared)
RSE<-append(RSE,summary(model_5)$sigma)
#Five predictors added
model_6<-update(model_5, . ~ . + lcp)
summary(model_6)
R_sq<-append(R_sq,summary(model_6)$r.squared)
RSE<-append(RSE,summary(model_6)$sigma)
#Six predictors added
model_7<-update(model_6, . ~ . + pgg45)
summary(model_7)
R_sq<-append(R_sq, summary(model_7)$r.squared)
RSE<-append(RSE, summary(model_7)$sigma)
#Seven predictors
model_8<-update(model_7, . ~ . + gleason)
summary(model_8)
R_sq<-append(R_sq, summary(model_8)$r.squared)
RSE<-append(RSE, summary(model_8)$sigma)
Model<-seq(1,8,1)
plot(Model,R_sq)
Model<-seq(1,8,1)
plot(Model,R_sq)
lines(RSE)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b")
lines(RSE)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b")
lines(Model,RSE)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",xlim=c(0.5,1))
lines(Model,RSE)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,1))
lines(Model,RSE)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,1))
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=17)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=16)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=15)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=14)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=13)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=12)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=1)
lines(Model,RSE,type="b")
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=2)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=3)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=4)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=5)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=6)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=7)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=8)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=9)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=10)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=11)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=12)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=13)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=14)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=15)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=16)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=17)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=18)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=20)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=21)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=22)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=23)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=24)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=4)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=25)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19)
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue")
lines(Model,RSE,type="b")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue")
lines(Model,RSE,type="b",pch=18,col="green")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue")
lines(Model,RSE,type="b",pch=19,col="green")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue")
lines(Model,RSE,type="b",pch=19,col="red")
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue")
lines(Model,RSE,type="b",pch=19,col="red")
legend("topright", legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty = 1:2, cex=0.8)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue")
lines(Model,RSE,type="b",pch=19,col="red")
legend("topright", legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty = 1, cex=0.8)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue")
lines(Model,RSE,type="b",pch=19,col="red")
legend("topright", legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty = 1, cex=1.2)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue")
lines(Model,RSE,type="b",pch=19,col="red")
legend("topright", legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty = 1, cex=1)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue",ylab="R-squared, Residual Standard Errors")
lines(Model,RSE,type="b",pch=19,col="red")
legend("topright", legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty = 1, cex=1)
legend("topright", legend=c("Residual Standard Errors", "R-squared"),
col=c("red", "blue"), lty = 1, cex=1)
Model<-seq(1,8,1)
plot(Model,R_sq,type="b",ylim=c(0.5,0.9),pch=19,col="blue",ylab="R-squared, Residual Standard Errors")
lines(Model,RSE,type="b",pch=19,col="red")
legend("topright", legend=c("Residual Standard Errors", "R-squared"),
col=c("red", "blue"), lty = 1, cex=1)
ggplot(aes(x=Model, y=R_sq))
install.packages("ggplot")
install.packages("ggplot2")
library(ggplot2)
library(faraway)
library(ggplot2)
data("teengamb")
ggplot(aes(x=Model, y=R_sq))
ggplot(R_sq, aes(x=Model, y=R_sq))
ggplot(as.data.frame(R_sq,Model) R_sq, aes(x=Model, y=R_sq))
plot_data<-as.data.frame(Model)
ggplot(as.data.frame(R_sq,Model) R_sq, aes(x=Model, y=R_sq))
plot_data<-as.data.frame(Model)
plot<-cbind(plot,R_sq,RSE)
ggplot(as.data.frame(R_sq,Model) R_sq, aes(x=Model, y=R_sq))
plot_data<-as.data.frame(Model)
plot<-cbind(plot,R_sq,RSE)
ggplot(plot_data, aes(x=Model, y=R_sq))
View(plot_data)
plot_data<-as.data.frame(Model)
plot<-cbind(plot,R_sq)
ggplot(plot_data, aes(x=Model, y=R_sq))
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
ggplot(plot_data, aes(x=Model, y=R_sq))
View(plot_data)
rm(plot)
View(plot_data)
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
qplot(Model,R_sq,data=plot_data)
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
qplot(Model,R_sq,data=plot_data)+
qplot(Model,RSE,data = plot_data)
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
qplot(Model,R_sq,data=plot_data)+
geom_point(Model,RSE,data = plot_data)
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) + geom_point()
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) + geom_point()+
labs(x="Model", y="R-square, RSE")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=2, color="grey20") +
geom_point(color="red")
labs(x="Model", y="R-square, RSE")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=1, color="grey20") +
geom_point(color="red")
labs(x="Model", y="R-square, RSE")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=1, color="grey20") +
geom_point(color="blue")
labs(x="Model", y="R-square, RSE")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=c(R_sq,RSE)) +
geom_line(linetype=1, color="grey20") +
geom_point(color="blue")
labs(x="Model", y="R-square, RSE")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=c(R_sq,RSE))) +
geom_line(linetype=1, color="grey20") +
geom_point(color="blue")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=1, color="grey20") +
geom_point(color="blue")
labs(x="Model", y="R-square, RSE")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=1, color="grey20") +
geom_point(color="blue")+
labs(x="Model", y="R-square, RSE")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=3, color="grey20") +
geom_point(color="blue")+
labs(x="Model", y="R-squared, RSE")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=4, color="grey20") +
geom_point(color="blue")+
labs(x="Model", y="R-squared, RSE")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=4, color="grey20") +
geom_point(color="blue")+
labs(x="Model", y="R-squared, RSE")+
geom_line(aes(y = RSE), color = "red", linetype = "dotted")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=4, color="grey20") +
geom_point(color="blue")+
labs(x="Model", y="R-squared, RSE")+
geom_line(aes(y = RSE), color = "red", linetype = 4)
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=4, color="grey20") +
geom_point(color="blue")+
labs(x="Model", y="R-squared, RSE")+
geom_line(aes(y = RSE), linetype = 4)=
geom_point(color="red")
plot_data<-as.data.frame(Model)
plot_data<-cbind(plot_data,R_sq,RSE)
# qplot(Model,R_sq,data=plot_data)+
#   geom_point(Model,RSE,data = plot_data)
ggplot(data=plot_data, aes(x=Model, y=R_sq)) +
geom_line(linetype=4, color="grey20") +
geom_point(color="blue")+
labs(x="Model", y="R-squared, RSE")+
geom_line(aes(y = RSE), linetype = 4)+
geom_point(color="red")
sqrt(3.97)
log(100)
log(e^2)
log(exp(2))
source('~/Desktop/Winter Quarter 2021/STATS 315A/Homeworks/Stanford-STATS-315A/PS3/counties_interaction.R', echo=TRUE)
getwd()
setwd("/Desktop/Spring Quarter 2021")
setwd("Desktop/Spring Quarter 2021")
setwd("STATS 315B")
setwd("Homeworks")
list.files(getwd())
setwd("Stanford-STATS-315B")
list.files(getwd())
setwd("315B_HW2")
list.files(getwd())
spam_train<- read.csv("spam_stats315B_train.csv")
spam_test<-read.csv("spam_stats315B_test.csv")
View(spam_train)
View(spam_train)
colnames(spam_train)<-rflabs
rflabs<-c("make", "address", "all", "3d", "our", "over", "remove","internet",
"order", "mail", "receive", "will","people", "report", "addresses",
"free", "business","email", "you", "credit", "your", "font","000","money",
"hp", "hpl", "george", "650", "lab", "labs","telnet", "857", "data", "415",
"85", "technology", "1999","parts","pm", "direct", "cs", "meeting", "original",
"project","re","edu", "table", "conference", ";", "(", "[", "!", "$", "#","CAPAVE",
"CAPMAX", "CAPTOT","type")
colnames(spam_train)<-rflabs
View(spam_test)
View(spam_train)
colnames(spam_test)<-rflabs
View(spam_test)
min(spam_train$make)
max(spam_train$make)
max(spam_train$address)
names(spam_train)
max(spam_train$all)
max(spam_train$3d)
max(spam_train$`3d')
train_data<-spam[sample(nrow(spam)),]
train_data<-spam_train[sample(nrow(spam_train)),]
set.seed(444)
gbm0<-gbm(type~.,data=train_data,train.fraction=0.8,interaction.depth=4,
shrinkage=.05,n.trees=2500,bag.fraction=0.5,cv.folds=5,
distribution="bernoulli",verbose=T)
library(dplyr)
library(gbm)
set.seed(444)
gbm0<-gbm(type~.,data=train_data,train.fraction=0.8,interaction.depth=4,
shrinkage=.05,n.trees=2500,bag.fraction=0.5,cv.folds=5,
distribution="bernoulli",verbose=T)
gbm0<-gbm(type~ .,data=train_data,train.fraction=0.8,interaction.depth=4,
shrinkage=.05,n.trees=2500,bag.fraction=0.5,cv.folds=5,
distribution="bernoulli",verbose=T)
set.seed(444)
gbm0<-gbm(type~.,data=train_data,train.fraction=0.8,interaction.depth=4,
shrinkage=.05,n.trees=2500,bag.fraction=0.5,cv.folds=5,
distribution="bernoulli",verbose=T)
gbm0<-gbm(type~.,data=train_data,train.fraction=0.8,interaction.depth=4,
shrinkage=.05,n.trees=500,bag.fraction=0.5,cv.folds=5,
distribution="bernoulli",verbose=T)
